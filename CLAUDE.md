# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## ğŸ¯ é¡¹ç›®æ¦‚è¿°
è¿™æ˜¯ä¸€ä¸ªåŸºäº Next.js çš„å…¨æ ˆåº”ç”¨æ¨¡æ¿ï¼Œé‡‡ç”¨ç°ä»£åŒ–æŠ€æœ¯æ ˆå’Œæ¶æ„è®¾è®¡ã€‚é¡¹ç›®åŒ…å«å‰ç«¯å®¢æˆ·ç«¯ã€åç«¯ API æœåŠ¡ä»¥åŠæ¡Œé¢ç«¯ Tauri åº”ç”¨ã€‚

## ğŸ› ï¸ å¼€å‘ç¯å¢ƒä¸å‘½ä»¤

### å®¢æˆ·ç«¯å¼€å‘ (client)
```bash
# å¼€å‘æœåŠ¡å™¨
bun dev                    # å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼Œç«¯å£ 3333ï¼Œä½¿ç”¨ Turbopack
bun build                 # æ„å»ºç”Ÿäº§ç‰ˆæœ¬
bun start                 # å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
bun lint                  # ä½¿ç”¨ Biome è¿›è¡Œä»£ç æ£€æŸ¥å’Œæ ¼å¼åŒ–
```

### åç«¯å¼€å‘ (server)
```bash
cd server && bun dev       # å¯åŠ¨ Cloudflare Workers å¼€å‘æœåŠ¡å™¨
cd server && bun deploy   # éƒ¨ç½²åˆ° Cloudflare Workers
cd server && bun test     # è¿è¡Œæµ‹è¯•
```

### ä»£ç è´¨é‡å·¥å…·
- **Biome.js**: æ›¿ä»£ ESLint + Prettierï¼Œæä¾›ä»£ç æ£€æŸ¥å’Œæ ¼å¼åŒ–
- **Husky + lint-staged**: Git hooks è‡ªåŠ¨åŒ–ä»£ç æ£€æŸ¥
- **Commitizen**: è§„èŒƒåŒ–æäº¤ä¿¡æ¯

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### å‰ç«¯æ¶æ„ (Next.js App Router)
- **ç›®å½•ç»“æ„**: `src/app/[locale]/` - æ”¯æŒå›½é™…åŒ–çš„è·¯ç”±ç»“æ„
- **ç»„ä»¶è®¾è®¡**: åŸºäº Radix UI + Tailwind CSS çš„ç»„ä»¶ç³»ç»Ÿ
- **çŠ¶æ€ç®¡ç†**: Zustand + React Query (TanStack Query)
- **å›½é™…åŒ–**: next-intl æ›¿ä»£ i18next
- **æ ·å¼**: Tailwind CSS v4 + shadcn/ui ç»„ä»¶åº“

### åç«¯æ¶æ„ (tRPC + Cloudflare Workers)
- **API å±‚**: tRPC v11 æä¾›ç±»å‹å®‰å…¨çš„ RPC è°ƒç”¨
- **æ•°æ®åº“**: Prisma ORM + PostgreSQL (Neon/Supabase)
- **è¿è¡Œæ—¶**: Cloudflare Workers æ— æœåŠ¡å™¨æ¶æ„
- **ç¼“å­˜**: tRPC Next Cache é“¾æ¥ï¼Œ5ç§’é‡æ–°éªŒè¯

### æ¡Œé¢ç«¯ (Tauri)
- **åŸç”Ÿåº”ç”¨**: åŸºäº Rust çš„ Tauri æ¡Œé¢åº”ç”¨
- **é…ç½®**: `src-tauri/` ç›®å½•åŒ…å« Tauri é…ç½®

## ğŸ“ å…³é”®ç›®å½•ç»“æ„

```
src/
â”œâ”€â”€ app/[locale]/          # å›½é™…åŒ–è·¯ç”±
â”œâ”€â”€ components/            # React ç»„ä»¶
â”‚   â”œâ”€â”€ ui/               # shadcn/ui åŸºç¡€ç»„ä»¶
â”‚   â”œâ”€â”€ common/           # é€šç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ cards/            # å¡ç‰‡ç»„ä»¶
â”‚   â””â”€â”€ providers/        # ä¸Šä¸‹æ–‡æä¾›è€…
â”œâ”€â”€ lib/trpc/             # tRPC å®¢æˆ·ç«¯é…ç½®
â”œâ”€â”€ i18n/                 # å›½é™…åŒ–é…ç½®
â”œâ”€â”€ layouts/              # å¸ƒå±€ç»„ä»¶
â””â”€â”€ stores/               # Zustand çŠ¶æ€ç®¡ç†

server/
â”œâ”€â”€ src/                  # åç«¯æºç 
â”‚   â”œâ”€â”€ router.ts         # tRPC è·¯ç”±å®šä¹‰
â”‚   â”œâ”€â”€ db.ts            # æ•°æ®åº“è¿æ¥
â”‚   â””â”€â”€ context.ts       # è¯·æ±‚ä¸Šä¸‹æ–‡
â”œâ”€â”€ prisma/              # æ•°æ®åº“æ¨¡å¼
â””â”€â”€ test/                # æµ‹è¯•æ–‡ä»¶
```

## ğŸ”§ æ ¸å¿ƒæŠ€æœ¯ç‰¹æ€§

### ç±»å‹å®‰å…¨
- **ç«¯åˆ°ç«¯ç±»å‹å®‰å…¨**: tRPC + TypeScript + Zod éªŒè¯
- **è·¯å¾„æ˜ å°„**: `@/*` æŒ‡å‘ `src/*`ï¼Œ`@server/*` æŒ‡å‘ `server/*`

### å›½é™…åŒ–æ”¯æŒ
- **å¤šè¯­è¨€è·¯ç”±**: åŸºäºè·¯å¾„å‰ç¼€çš„è¯­è¨€åˆ‡æ¢ (`/zh/`, `/en/`)
- **æ¶ˆæ¯ç®¡ç†**: `messages/` ç›®å½•ä¸‹çš„ JSON æ–‡ä»¶
- **ä¸­é—´ä»¶**: è‡ªåŠ¨è¯­è¨€æ£€æµ‹å’Œé‡å®šå‘

### å¼€å‘ä½“éªŒ
- **çƒ­é‡è½½**: Next.js + Turbopack å¿«é€Ÿå¼€å‘
- **ä»£ç æ ¼å¼åŒ–**: Biome.js ç»Ÿä¸€ä»£ç é£æ ¼
- **ç±»å‹æ£€æŸ¥**: TypeScript ä¸¥æ ¼æ¨¡å¼

## ğŸš€ éƒ¨ç½²é…ç½®

### å‰ç«¯éƒ¨ç½²
- **é™æ€å¯¼å‡º**: Next.js æ”¯æŒé™æ€å¯¼å‡º (å½“å‰æ³¨é‡ŠçŠ¶æ€)
- **å›¾ç‰‡ä¼˜åŒ–**: é™æ€å¯¼å‡ºæ—¶ç¦ç”¨å›¾ç‰‡ä¼˜åŒ–
- **æ„å»ºä¼˜åŒ–**: ESLint åœ¨æ„å»ºæ—¶å¿½ç•¥

### åç«¯éƒ¨ç½²
- **Cloudflare Workers**: æ— æœåŠ¡å™¨éƒ¨ç½²
- **æ•°æ®åº“**: Prisma + Neon/Supabase
- **ç¯å¢ƒå˜é‡**: é€šè¿‡ Wrangler é…ç½®

## ğŸ”’ å®‰å…¨ä¸éªŒè¯

### è¾“å…¥éªŒè¯
- **Zod Schema**: æ‰€æœ‰ tRPC è·¯ç”±ä½¿ç”¨ Zod è¿›è¡Œè¾“å…¥éªŒè¯
- **ç±»å‹å®‰å…¨**: ç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥

### ä»£ç è´¨é‡
- **Git Hooks**: æäº¤å‰è‡ªåŠ¨è¿è¡Œä»£ç æ£€æŸ¥
- **æ ¼å¼åŒ–**: Biome.js ç¡®ä¿ä»£ç é£æ ¼ä¸€è‡´
- **æäº¤è§„èŒƒ**: Conventional Commits æ ¼å¼

## ğŸ“ å¼€å‘æ³¨æ„äº‹é¡¹

### ä»£ç è§„èŒƒ
- ä½¿ç”¨ Tab ç¼©è¿›ï¼Œå®½åº¦ 2 ä¸ªç©ºæ ¼
- å•å¼•å·å­—ç¬¦ä¸²ï¼Œåˆ†å·ç»“å°¾
- 80 å­—ç¬¦è¡Œå®½é™åˆ¶
- é¿å…åœ¨ UI ç»„ä»¶ä¸­ä½¿ç”¨æ•°ç»„ç´¢å¼•ä½œä¸º key

### ç»„ä»¶å¼€å‘
- ä¼˜å…ˆä½¿ç”¨ Server Components
- å®¢æˆ·ç«¯ç»„ä»¶ä½¿ç”¨ `'use client'` æŒ‡ä»¤
- éµå¾ª Radix UI + Tailwind CSS çš„è®¾è®¡æ¨¡å¼

### API å¼€å‘
- æ‰€æœ‰ API é€šè¿‡ tRPC è·¯ç”±å®šä¹‰
- ä½¿ç”¨ Prisma è¿›è¡Œæ•°æ®åº“æ“ä½œ
- åˆ©ç”¨ Zod è¿›è¡Œè¾“å…¥è¾“å‡ºéªŒè¯
